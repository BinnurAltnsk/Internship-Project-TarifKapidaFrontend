{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import RecipeReviewForm from\"./RecipeReviewForm\";import{reviewService}from\"../../services/reviewService\";import PaginatedRecipeReviewList from\"../Review/PaginatedRecipeReviewList\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RecipeDetailModal(_ref){let{recipe,user,onClose}=_ref;const[averageRating,setAverageRating]=useState(null);const[reviewCount,setReviewCount]=useState(0);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");useEffect(()=>{const fetchAverageRating=async()=>{try{var _response$data$averag;setLoading(true);setError(\"\");const API_BASE_URL=localStorage.getItem('API_BASE_URL');const response=await axios.get(`${API_BASE_URL}/api/Review/GetAverageRating/${recipe.recipeId}`);setAverageRating(((_response$data$averag=response.data.averageRating)===null||_response$data$averag===void 0?void 0:_response$data$averag.toFixed(1))||null);setReviewCount(response.data.reviewCount||0);}catch(err){console.error(\"Ortalama değerlendirme yüklenemedi:\",err);setError(\"Ortalama değerlendirme yüklenemedi.\");}finally{setLoading(false);}};if(recipe.recipeId){fetchAverageRating();}},[recipe.recipeId]);return/*#__PURE__*/_jsx(\"div\",{className:\"modal\",onClick:onClose,style:{position:\"fixed\",top:0,left:0,width:\"100vw\",height:\"100vh\",background:\"rgba(0,0,0,0.4)\",zIndex:1000,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#fff\",color:\"#333\",borderRadius:16,padding:32,maxWidth:600,width:\"100%\",position:\"relative\",maxHeight:\"90vh\",overflowY:\"auto\"},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{position:\"absolute\",top:16,right:16,background:\"#FF6B6B\",color:\"#fff\",border:\"none\",borderRadius:8,padding:\"4px 12px\",fontSize:18,cursor:\"pointer\"},children:\"Kapat\"}),recipe.recipeImageUrl&&/*#__PURE__*/_jsx(\"img\",{src:recipe.recipeImageUrl,alt:recipe.recipeName,style:{width:\"100%\",height:300,objectFit:\"cover\",borderRadius:12,marginBottom:20},onError:e=>{e.target.src=\"https://via.placeholder.com/600x300/FF6B6B/FFFFFF?text=Tarif+Resmi\";}}),/*#__PURE__*/_jsx(\"h2\",{children:recipe.recipeName}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Malzemeler:\"}),/*#__PURE__*/_jsx(\"p\",{children:recipe.recipeIngredients})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Haz\\u0131rlan\\u0131\\u015F\\u0131:\"}),/*#__PURE__*/_jsx(\"p\",{children:recipe.recipeInstructions})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:24},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"De\\u011Ferlendirmeler:\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Y\\xFCkleniyor...\"}):error?/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:error}):averageRating?/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u2B50 \",averageRating,\" / 5\",/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:8,color:\"#777\"},children:[\"(\",reviewCount,\" de\\u011Ferlendirme)\"]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Hen\\xFCz de\\u011Ferlendirme yok.\"})]}),/*#__PURE__*/_jsx(PaginatedRecipeReviewList,{recipeId:recipe.recipeId}),user&&/*#__PURE__*/_jsx(RecipeReviewForm,{recipeId:recipe.recipeId,user:user,onReviewSubmit:()=>{// Değerlendirme yapıldığında ortalama tekrar yüklensin\naxios.get(`http://localhost:7175/api/Review/GetAverageRating/${recipe.recipeId}`).then(res=>{var _res$data$averageRati;setAverageRating((_res$data$averageRati=res.data.averageRating)===null||_res$data$averageRati===void 0?void 0:_res$data$averageRati.toFixed(1));setReviewCount(res.data.reviewCount);});}})]})});}","map":{"version":3,"names":["React","useEffect","useState","axios","RecipeReviewForm","reviewService","PaginatedRecipeReviewList","jsx","_jsx","jsxs","_jsxs","RecipeDetailModal","_ref","recipe","user","onClose","averageRating","setAverageRating","reviewCount","setReviewCount","loading","setLoading","error","setError","fetchAverageRating","_response$data$averag","API_BASE_URL","localStorage","getItem","response","get","recipeId","data","toFixed","err","console","className","onClick","style","position","top","left","width","height","background","zIndex","display","alignItems","justifyContent","children","color","borderRadius","padding","maxWidth","maxHeight","overflowY","e","stopPropagation","right","border","fontSize","cursor","recipeImageUrl","src","alt","recipeName","objectFit","marginBottom","onError","target","recipeIngredients","recipeInstructions","marginLeft","onReviewSubmit","then","res","_res$data$averageRati"],"sources":["C:/Users/x_user/Desktop/Internship-Project-TarifKapidaFrontend/src/components/Recipe/RecipeDetailModal.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport RecipeReviewForm from \"./RecipeReviewForm\";\r\nimport { reviewService } from \"../../services/reviewService\";\r\nimport PaginatedRecipeReviewList from \"../Review/PaginatedRecipeReviewList\";\r\n\r\n\r\nexport default function RecipeDetailModal({ recipe, user, onClose }) {\r\n  const [averageRating, setAverageRating] = useState(null);\r\n  const [reviewCount, setReviewCount] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchAverageRating = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(\"\");\r\n        const API_BASE_URL = localStorage.getItem('API_BASE_URL');\r\n        const response = await axios.get(`${API_BASE_URL}/api/Review/GetAverageRating/${recipe.recipeId}`);\r\n        setAverageRating(response.data.averageRating?.toFixed(1) || null);\r\n        setReviewCount(response.data.reviewCount || 0);\r\n      } catch (err) {\r\n        console.error(\"Ortalama değerlendirme yüklenemedi:\", err);\r\n        setError(\"Ortalama değerlendirme yüklenemedi.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    if (recipe.recipeId) {\r\n      fetchAverageRating();\r\n    }\r\n  }, [recipe.recipeId]);\r\n  \r\n  return (\r\n    <div\r\n      className=\"modal\"\r\n      onClick={onClose}\r\n      style={{\r\n        position: \"fixed\",\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n        background: \"rgba(0,0,0,0.4)\",\r\n        zIndex: 1000,\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n      }}\r\n    >\r\n      <div\r\n        style={{\r\n          background: \"#fff\",\r\n          color: \"#333\",\r\n          borderRadius: 16,\r\n          padding: 32,\r\n          maxWidth: 600,\r\n          width: \"100%\",\r\n          position: \"relative\",\r\n          maxHeight: \"90vh\",\r\n          overflowY: \"auto\",\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <button\r\n          onClick={onClose}\r\n          style={{\r\n            position: \"absolute\",\r\n            top: 16,\r\n            right: 16,\r\n            background: \"#FF6B6B\",\r\n            color: \"#fff\",\r\n            border: \"none\",\r\n            borderRadius: 8,\r\n            padding: \"4px 12px\",\r\n            fontSize: 18,\r\n            cursor: \"pointer\",\r\n          }}\r\n        >\r\n          Kapat\r\n        </button>\r\n\r\n        {/* Görsel */}\r\n        {recipe.recipeImageUrl && (\r\n          <img\r\n            src={recipe.recipeImageUrl}\r\n            alt={recipe.recipeName}\r\n            style={{\r\n              width: \"100%\",\r\n              height: 300,\r\n              objectFit: \"cover\",\r\n              borderRadius: 12,\r\n              marginBottom: 20,\r\n            }}\r\n            onError={(e) => {\r\n              e.target.src = \"https://via.placeholder.com/600x300/FF6B6B/FFFFFF?text=Tarif+Resmi\";\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {/* Başlık */}\r\n        <h2>{recipe.recipeName}</h2>\r\n\r\n        {/* Malzemeler */}\r\n        <div style={{ marginBottom: 16 }}>\r\n          <h4>Malzemeler:</h4>\r\n          <p>{recipe.recipeIngredients}</p>\r\n        </div>\r\n\r\n        {/* Hazırlanış */}\r\n        <div style={{ marginBottom: 16 }}>\r\n          <h4>Hazırlanışı:</h4>\r\n          <p>{recipe.recipeInstructions}</p>\r\n        </div>\r\n\r\n        {/* Ortalama Puan */}\r\n        <div style={{ marginBottom: 24 }}>\r\n          <h4>Değerlendirmeler:</h4>\r\n          {loading ? (\r\n            <p>Yükleniyor...</p>\r\n          ) : error ? (\r\n            <p style={{ color: \"red\" }}>{error}</p>\r\n          ) : averageRating ? (\r\n            <p>\r\n              ⭐ {averageRating} / 5\r\n              <span style={{ marginLeft: 8, color: \"#777\" }}>({reviewCount} değerlendirme)</span>\r\n            </p>\r\n          ) : (\r\n            <p>Henüz değerlendirme yok.</p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Yorum Listesi */}\r\n        <PaginatedRecipeReviewList recipeId={recipe.recipeId} />\r\n\r\n        {/* Yorum Formu */}\r\n        {user && (\r\n          <RecipeReviewForm\r\n            recipeId={recipe.recipeId}\r\n            user={user}\r\n            onReviewSubmit={() => {\r\n              // Değerlendirme yapıldığında ortalama tekrar yüklensin\r\n              axios\r\n                .get(`http://localhost:7175/api/Review/GetAverageRating/${recipe.recipeId}`)\r\n                .then((res) => {\r\n                  setAverageRating(res.data.averageRating?.toFixed(1));\r\n                  setReviewCount(res.data.reviewCount);\r\n                });\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}